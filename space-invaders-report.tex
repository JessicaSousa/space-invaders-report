\documentclass[]{book}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage[]{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\PassOptionsToPackage{hyphens}{url} % url is loaded by hyperref
\usepackage[unicode=true]{hyperref}
\hypersetup{
            pdftitle={Space Invaders - IA},
            pdfauthor={Ivan de Jesus Pereira Pinto},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage{natbib}
\bibliographystyle{apalike}
\usepackage{longtable,booktabs}
% Fix footnotes in tables (requires footnote package)
\IfFileExists{footnote.sty}{\usepackage{footnote}\makesavenoteenv{long table}}{}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

% set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother

\usepackage{booktabs}
\usepackage{amsthm}

%encoding
%--------------------------------------
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
%--------------------------------------

%Portuguese-specific commands
%--------------------------------------
\usepackage[brazil]{babel}
%--------------------------------------
\makeatletter
\def\thm@space@setup{%
  \thm@preskip=8pt plus 2pt minus 4pt
  \thm@postskip=\thm@preskip
}
\makeatother

\title{Space Invaders - IA}
\author{Ivan de Jesus Pereira Pinto}
\date{2020-02-13}

\begin{document}
\maketitle

{
\setcounter{tocdepth}{1}
\tableofcontents
}
\chapter*{Resumo}\label{resumo}
\addcontentsline{toc}{chapter}{Resumo}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\begin{center}\includegraphics[width=0.5\linewidth]{content/imgs/game} \end{center}

Neste relatório descrevemos as técnicas utilizadas nos agentes do jogo
\emph{space invaders}, além do processo de treinamento.

\chapter{Introdução}\label{intro}

Esse projeto visa o desenvolvimento de técnicas da área de Inteligência
Artificial para o jogo de Space Invaders. Especificamente almeja-se a
implementação de IAs para as naves inimigas. A maior parte da pesquisa
nessa área se dá no desenvolvimento de Agentes que aprendem a jogar
contra o ambiente, no estilo de um processo de decisão de Markov
conforme ilustramos na Figura \ref{fig:pdm}:

\begin{figure}

{\centering \includegraphics[width=0.5\linewidth]{content/imgs/agente-ambiente} 

}

\caption{Processo de decisão de markov. [@faria1999explorando]}\label{fig:pdm}
\end{figure}

O SpaceInvaders aqui desenvolvido almeja no entanto politicas de
controle para o ambiente, que seriam os inimigos. O jogador(humano) se
torna o ambiente nesse caso. Para que fosse possível a implementação das
técnicas de IA, foi necessário o desenvolvimento do jogo, de um
simulador, e de um surrogate para o jogador. Os objetivos deste trabalho
são listados a seguir:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Construção do jogo de Space Invaders eficiente em C.
\item
  Construção de um Forward Simulator
\item
  Desenvolvimento de um surrugate Player que substitua o humano em tempo
  de planning ou treino.
\item
  Implementação de Técnicas de IA (Planning e Aprendizado)
\end{enumerate}

No capítulo \ref{methods} descrevemos as técnicas utilizadas neste
trabalho, e no capítulo \ref{app} descrevemos a implementação como um
todo.

\chapter{Metodologia}\label{methods}

Descrevemos aqui os métodos utilizados neste projeto. Importante: a
recompensa é +1 pra cada dano recebido pela nave do jogador( do ponto de
vista dos oponente, os quais estamos tentanto otimizar) e -1 pra cada
dano recebido pela nave oponente. Além disso, +100 é dado de o tiro
inimigo matar o oponente, e -100 é recebido se uma nave inimiga morrer.

\section{Neural Network}\label{neural-network}

Uma rede neural de 1 camada escondida foi treinada com busca aleatória
no espaço de pesos. O processo é muito simples, com a rede sendo
avaliada em um número de partidas com os pesos gerados, e caso ela seja
a melhor rede até agora( no acúmulo de recompensas), salvamos seus pesos
e os modificamos em direções aleatória usando ruído gaussiano. O
resultado foi aquém do esperado, talvez devido a complexidade do
problema e a esparcidade das recompensas, que ocorrem com pouca
frequência.

\section{Monte Carlo 1-Step Planning}\label{monte-carlo-1-step-planning}

Utiliza-se simulação monte carlo para se estimar o retorno esperado de
cada ação possível no estado atual. Rollouts/playouts/partidas
aleatórias são simuladas até certo passo estipulado. A recompensa
acumulada até aquele passo é utilizada como estimativa do retorno
esperado. Quanto mais simulações melhor, logo é importante a velocidade
do simulador. O funcionamento é ilustrado na figura abaixo:

\begin{center}\includegraphics[width=0.5\linewidth]{content/imgs/MC} \end{center}

Por causa do enorme número de ações, esse método se torna menos
eficiente. Melhorias possíveis são a utilização de métodos que
selecionam subconjuntos de ações disponíveis.

\section{Monte Carlo Tree Search}\label{monte-carlo-tree-search}

O método de melhor resultado, é uma melhoria do MC onde se constroi uma
árvore de ações na memória. Seu funcionamento se dá pelos 4 passos
ilustrados na figura abaixo:

\begin{center}\includegraphics[width=0.5\linewidth]{content/imgs/MCTS} \end{center}

\section{Reinforcement Learning}\label{reinforcement-learning}

\chapter{Aplicação}\label{app}

Some \emph{significant} applications are demonstrated in this chapter.

\section{Instalaçao}\label{instalauxe7ao}

Para instalar no Windows é necessário um compilador de c(gcc foi
utilizado no desenvolvimento), e de python 3.6 de 32 bits. Utilizando o
anaconda basta criar um ambiente como se segue: Colocar variável de
ambiente: set CONDA\_FORCE\_32BIT=1\\
Criar ambiente: conda create -n py36\_32 python=3.6 Ativar ambiente:
conda activate py36\_32 Instalar numpy e pygame: pip install
numpy,pygame

As depedências do python devem ter sido satisfeitas. O programa com UI
vai precisar chamar o jogo SpaceInvaders em C, para que possa funcionar.
Temos que compilar o código em C com o comando a seguir, da pasta
SpaceInvaders

gcc -Wall -fPIC -shared src/Space.c src/list.c src/genann.c -o
src/Space.so

Se tudo tiver dado certo, o jogo deve funcionar. Basta utilizar python
menu.py

\section{Jogo}\label{jogo}

O Jogo Space invader foi desenvolvido em C de modo a ser o mais
eficiente possível. Além disso, foram utilizadas estruturas de dados com
menor complexidade, como por exemplo: 1. o uso de Matriz para
representar o espaço do jogo, tendo O(1) para checar se a nave do
jogador ou dos oponentes receberam dados dos tiros. 2. O(n) para mover
os tiros, onde n é a quantidade de tiros ativos na tela, armazenados em
uma lista. Tiros fora da tela são descartados Um foward simulator foi
implementado para permitir que os agentes possam fazer simulações, para
planning e treinamento. Os comandos para jogar são os seguintes:
direcionais movem a nave, e espaço atira.

O Vídeo abaixo demonstra uma partida rapida de um humano contra a IA
MCTS

\chapter{Considerações finais}\label{considerauxe7uxf5es-finais}

We have finished a nice book.

\bibliography{references.bib,packages.bib}

\end{document}
